<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Scanner et Écrire NFC</title>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const scanButton = document.getElementById('scanButton');
            const writeButton = document.getElementById('writeButton');
            const dataDisplay = document.getElementById('dataDisplay');
            const audio = new Audio('ROBTVox_Notification lasomarie 1 (ID 2059)_LS.wav'); // Assurez-vous que le chemin d'accès est correct.
            const nameInput = document.getElementById('nameInput');
            const lastNameInput = document.getElementById('lastNameInput');

            scanButton.addEventListener('click', async function() {
                if ('NDEFReader' in window) {
                    try {
                        const ndef = new NDEFReader();
                        await ndef.scan();

                        ndef.onreading = event => {
                            const message = event.message;
                            dataDisplay.innerHTML = ''; // Effacer les données précédentes
                            for (const record of message.records) {
                                const textDecoder = new TextDecoder(record.encoding);
                                dataDisplay.innerHTML += textDecoder.decode(record.data);
                            }
                            audio.play(); // Jouer le bip après la lecture
                        };

                        ndef.onerror = () => {
                            console.error("Erreur lors de la lecture du tag NFC.");
                            dataDisplay.innerHTML = "Erreur lors de la lecture du tag NFC.";
                        };
                    } catch (error) {
                        console.error("Erreur d'accès NFC:", error);
                        dataDisplay.innerHTML = `Erreur d'accès NFC: ${error}`;
                    }
                } else {
                    alert("L'API Web NFC n'est pas supportée par ce navigateur.");
                }
            });

            writeButton.addEventListener('click', async function() {
                if ('NDEFReader' in window) {
                    try {
                        const ndef = new NDEFReader();
                        await ndef.write({
                            records: [{ recordType: "text", data: `${nameInput.value} ${lastNameInput.value}` }]
                        });
                        alert("Données écrites avec succès sur le tag NFC!");
                    } catch (error) {
                        console.error("Erreur lors de l'écriture sur le tag NFC:", error);
                        alert(`Erreur lors de l'écriture: ${error}`);
                    }
                } else {
                    alert("L'API Web NFC n'est pas supportée par ce navigateur.");
                }
            });
        });
    </script>
</head>
<body>
<h1>Scanner et Écrire NFC</h1>
<button id="scanButton">Scan</button>
<div id="dataDisplay"></div> <!-- Affichage des données NFC -->
<div id="formContainer">
    <input id="nameInput" type="text" placeholder="Prénom" />
    <input id="lastNameInput" type="text" placeholder="Nom" />
    <button id="writeButton">Écrire</button>
</div>
</body>
</html>
